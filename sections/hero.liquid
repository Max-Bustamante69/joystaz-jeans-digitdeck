{% comment %}
  Hero Section - Modular and fully editable
  Features:
  - Multiple slides support
  - Fully customizable content per slide
  - Responsive design
  - Autoplay and navigation controls
{% endcomment %}

<div class="hero relative flex items-end" style="min-height: {{ section.settings.min_height }}vh;">
  {% if section.blocks.size > 0 %}
    <div id="hero-swiper-{{ section.id }}" class="swiper">
      <div class="swiper-wrapper">
        {% for block in section.blocks %}
          {% case block.type %}
            {% when 'slide' %}
              <div class="swiper-slide">
                {% render 'hero-slide', slide: block.settings %}
              </div>
          {% endcase %}
        {% endfor %}
      </div>

      {% if section.blocks.size > 1 %}
        {% if section.settings.show_navigation %}
          <div class="swiper-button-next"></div>
          <div class="swiper-button-prev"></div>
        {% endif %}

        {% if section.settings.show_bullets %}
          <div class="swiper-pagination"></div>
        {% endif %}
      {% endif %}
    </div>
  {% else %}
    <div class="flex items-center justify-center w-full h-dvh bg-gray-100">
      <div class="text-center text-gray-500">
        <p class="text-lg mb-4">No slides added yet</p>
        <p class="text-sm">Add slides using the theme editor</p>
      </div>
    </div>
  {% endif %}
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const heroElement = document.getElementById('hero-swiper-{{ section.id }}');
    const slideCount = {{ section.blocks.size }};

    // Only initialize carousel if there are multiple slides
    if (heroElement && typeof Swiper !== 'undefined' && slideCount > 1) {
      new Swiper(heroElement, {
        slidesPerView: 1,
        spaceBetween: 0,
        loop: true,
        autoplay: {
          delay: {{ section.settings.autoplay_duration | default: 3000 }},
          disableOnInteraction: false,
          pauseOnMouseEnter: {{ section.settings.pause_on_hover | json }},
        },
        speed: {{ section.settings.animation_duration | default: 1000 }},
        grabCursor: true,
        navigation: {
          nextEl: '.swiper-button-next',
          prevEl: '.swiper-button-prev',
        },
        pagination: {
          el: '.swiper-pagination',
          clickable: true,
        },
        breakpoints: {
          1024: { slidesPerView: 1 },
          768: { slidesPerView: 1 },
          480: { slidesPerView: 1 }
        }
      });
    } else if (heroElement && slideCount === 1) {
      // For single slide, remove carousel classes and make it a static display
      heroElement.classList.remove('swiper');
      const wrapper = heroElement.querySelector('.swiper-wrapper');
      const slide = heroElement.querySelector('.swiper-slide');

      if (wrapper && slide) {
        // Remove carousel structure and make it a simple container
        wrapper.classList.remove('swiper-wrapper');
        slide.classList.remove('swiper-slide');

        // Move slide directly into the hero element
        heroElement.appendChild(slide);
        wrapper.remove();
      }
    } else if (heroElement) {
      console.warn('Swiper.js library not found. Make sure swiper-bundle.min.js is loaded in theme.liquid.');
    }
  });
</script>

<style>
  .swiper-pagination {
    position: absolute;
    left: 95%;
    bottom: 20px;
    z-index: 20;
  }

  .swiper-pagination-bullet {
    width: 12px;
    height: 12px;
    background: rgba(255, 255, 255, 0.5);
    opacity: 1;
    transition: all 0.3s ease;
  }

  .swiper-pagination-bullet-active {
    background: white;
    transform: scale(1.2);
  }

  .swiper-button-next,
  .swiper-button-prev {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    width: 48px;
    height: 48px;
    color: white;
    transition: all 0.3s ease;
  }

  .swiper-button-next:hover,
  .swiper-button-prev:hover {
    background: rgba(255, 255, 255, 0.3);
  }

  .swiper-button-next::after,
  .swiper-button-prev::after {
    font-size: 20px;
  }

  @media screen and (max-width: 768px) {
    .swiper-pagination {
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
    }

    .swiper-pagination-bullet {
      width: 10px;
      height: 10px;
    }

    .swiper-button-next,
    .swiper-button-prev {
      width: 40px;
      height: 40px;
    }

    .swiper-button-next::after,
    .swiper-button-prev::after {
      font-size: 16px;
    }
  }
</style>

{% schema %}
{
  "name": "Hero Section",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "range",
      "id": "min_height",
      "min": 50,
      "max": 100,
      "step": 5,
      "unit": "vh",
      "label": "Minimum Height",
      "default": 100
    },
    {
      "type": "range",
      "id": "autoplay_duration",
      "min": 1000,
      "max": 8000,
      "step": 500,
      "unit": "ms",
      "label": "Autoplay Duration",
      "default": 3000
    },
    {
      "type": "range",
      "id": "animation_duration",
      "min": 200,
      "max": 2000,
      "step": 100,
      "unit": "ms",
      "label": "Animation Duration",
      "default": 1000
    },
    {
      "type": "checkbox",
      "id": "pause_on_hover",
      "label": "Pause on Hover",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_navigation",
      "label": "Show Navigation Arrows",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_bullets",
      "label": "Show Bullet Navigation",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Hero Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Slide Image"
        },
        {
          "type": "url",
          "id": "image_url",
          "label": "Or Image URL (alternative to image picker)"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Slide Title",
          "default": "Viste el esp√≠ritu"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Slide Description",
          "default": "Creemos que la moda no es solo ropa es la historia que cuentas cada vez que te vistes"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button Text",
          "default": "Descubrelos"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button Link"
        },
        {
          "type": "select",
          "id": "button_style",
          "label": "Button Style",
          "options": [
            {
              "value": "",
              "label": "Default"
            },
            {
              "value": "px-6 py-3 border border-white",
              "label": "Transparent"
            },
            {
              "value": "underline  border-none text-sm",
              "label": "Underlined"
            }
          ],
          "default": ""
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Hero Section",
      "category": "Hero Sections",
      "blocks": [
        {
          "type": "slide"
        }
      ]
    }
  ]
}
{% endschema %}
